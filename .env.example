# Environment Variables Template
# Copy this file to .env.local and fill in your actual values
# DO NOT commit .env.local - it contains secrets!

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL connection string (Supabase recommended for production)
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=SCHEMA
# Development: Use Supabase project URL or local PostgreSQL
# Production: Railway auto-injects this variable
DATABASE_URL="postgresql://user:password@localhost:5432/mandarin_dev?schema=public"

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

# Node environment (development | production | test)
NODE_ENV="development"

# Backend server port (default: 3001)
PORT=3001

# Frontend URL for CORS (development: http://localhost:5173, production: your Vercel URL)
FRONTEND_URL="http://localhost:5173"

# =============================================================================
# JWT AUTHENTICATION
# =============================================================================

# JWT secret for access tokens (expires in 15 minutes)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# IMPORTANT: Use different secrets for dev and production!
JWT_SECRET="your-jwt-secret-key-change-in-production"

# JWT secret for refresh tokens (expires in 7 days)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_REFRESH_SECRET="your-jwt-refresh-secret-key-change-in-production"

# =============================================================================
# GOOGLE CLOUD SERVICES
# =============================================================================

# Google Cloud Text-to-Speech API credentials
# Service account JSON (single-line, escaped quotes)
# Get from: Google Cloud Console → IAM & Admin → Service Accounts → Create Key (JSON)
# Format: '{"type":"service_account","project_id":"...","private_key":"...","client_email":"..."}'
GOOGLE_TTS_CREDENTIALS_RAW='{"type":"service_account","project_id":"your-project","private_key":"-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n","client_email":"...@....iam.gserviceaccount.com"}'

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis connection URL (Railway auto-injects this variable in production)
# For local development, copy the REDIS_URL from Railway dashboard
# Format: redis://:password@host:port or redis://default:password@host:port
# Development & Production: Use same Railway Redis instance (separate database index via key prefixes)
REDIS_URL="redis://default:password@redis.railway.internal:6379"

# Enable/disable caching (set to "false" to disable Redis caching layer)
# When disabled, app uses NoOpCacheService (no-op cache operations)
CACHE_ENABLED="true"

# TTS cache TTL in seconds (default: 86400 = 24 hours)
# Audio synthesis results are cached to reduce API calls and improve response times
CACHE_TTL_TTS="86400"

# Conversation cache TTL in seconds (default: 3600 = 1 hour)
# AI-generated conversations are cached temporarily
CACHE_TTL_CONVERSATION="3600"

# Google Gemini API credentials (for conversation generation)
# Service account JSON (single-line, escaped quotes)
# Same format as GOOGLE_TTS_CREDENTIALS_RAW
GEMINI_API_CREDENTIALS_RAW='{"type":"service_account","project_id":"your-project","private_key":"-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n","client_email":"...@....iam.gserviceaccount.com"}'

# Google Cloud Storage bucket name (for audio/conversation caching)
# Create bucket in Google Cloud Console → Cloud Storage
GCS_BUCKET_NAME="your-bucket-name"

# Google Cloud Storage configuration for vocabulary CSVs (Story 13.6)
# Enable GCS for vocabulary data ("true" | "false")
# When enabled, backend fetches vocabulary from GCS bucket
# When disabled, backend falls back to local file system
GCS_ENABLED="true"

# GCS credentials (same service account as TTS, must have Storage Object Viewer role)
# Uses GOOGLE_TTS_CREDENTIALS_RAW by default (already configured above)
# Ensure service account has "Storage Object Viewer" role on mandarin-vocab-data bucket
GCS_CREDENTIALS_RAW='{"type":"service_account","project_id":"your-project","private_key":"-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n","client_email":"...@....iam.gserviceaccount.com"}'

# =============================================================================
# FRONTEND CONFIGURATION (Vite)
# =============================================================================

# Backend API base URL
# Development: http://localhost:3001
# Production: Your Railway backend URL (e.g., https://your-app.railway.app)
VITE_API_URL="http://localhost:3001"

# =============================================================================
# REDIS CONFIGURATION (Story 13.5)
# =============================================================================

# Redis connection URL
# Development: Use Railway Redis URL (copy from Railway dashboard)
# Production: Railway auto-injects this variable
# Format: redis://:password@host:port or rediss://... (with TLS)
REDIS_URL="redis://default:password@redis.railway.internal:6379"

# Enable/disable Redis caching (true | false)
# Set to "false" to disable caching and use NoOpCacheService
CACHE_ENABLED="true"

# TTS cache TTL in seconds (default: 86400 = 24 hours)
CACHE_TTL_TTS="86400"

# Conversation cache TTL in seconds (default: 3600 = 1 hour)
CACHE_TTL_CONVERSATION="3600"

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================

# Conversation mode (scaffold | real)
# - "scaffold" = use fixture data (no external API calls)
# - "real" = use Google Cloud TTS + Gemini API
CONVERSATION_MODE="real"

# =============================================================================
# NOTES
# =============================================================================
# 1. This file is committed to git and serves as documentation
# 2. Copy this file to .env.local and fill in real values
# 3. Never commit .env.local (it's in .gitignore)
# 4. In production (Railway), set these as environment variables in the dashboard
# 5. Railway auto-injects: DATABASE_URL, REDIS_URL (if Redis plugin added)
# 6. Generate secure secrets for production using crypto.randomBytes()
